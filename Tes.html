<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <link href="https://cdn.datatables.net/v/bs5/jszip-2.5.0/b-2.3.5/b-html5-2.3.5/datatables.min.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css">
<link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.2.0/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.datatables.net/1.13.3/css/dataTables.bootstrap5.min.css" rel="stylesheet">
<link href="https://cdn.datatables.net/responsive/2.4.0/css/responsive.bootstrap5.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap">


    <!-- Tag link untuk favicon -->
    <link rel="icon" href="https://tse2.mm.bing.net/th?id=OIP.PEzGjWR5KT5_WBfoONYflwHaHZ&pid=Api&P=0&h=180" type="image/x-icon" />
    <!-- Tag meta untuk gambar ketika dibagikan di media sosial -->
    <meta property="og:image" content="https://i.ibb.co/8d3cVFb/BG.png" />
    
    <title>Pendaftaran Santri Baru</title>
  </head>
  <body>
    <br> 
    
    <div class="container mt-4">
        <div class="row justify-content-center">
            <div class="col-md-6">
                <!-- Title Pembayaran -->
                <h1 class="title-header">PENBAYARAN SISWA</h1>
                
                <div class="form-group">
                    <label for="kelasMTs" class="form-label">Pilih Kelas</label>
                    <select id="kelasMTs" name="kelasMTs" class="form-select form-select-sm">
    <option value="Semua">Semua</option>
                        <!-- Kelas 7 -->
                        <option value="7A">7A</option>
                        <option value="7B">7B</option>
                        <option value="7C">7C</option>
                        <option value="7D">7D</option>
                        <option value="7E">7E</option>
                        <option value="7F">7F</option>
                        <option value="7G">7G</option>
                        <option value="7H">7H</option>
                        <!-- Kelas 8 -->
                        <option value="8A">8A</option>
                        <option value="8B">8B</option>
                        <option value="8C">8C</option>
                        <option value="8D">8D</option>
                        <option value="8E">8E</option>
                        <option value="8F">8F</option>
                        <option value="8G">8G</option>
                        <option value="8H">8H</option>
                        <option value="8I">8I</option>
                        <!-- Kelas 9 -->
                        <option value="9A">9A</option>
                        <option value="9B">9B</option>
                        <option value="9C">9C</option>
                        <option value="9D">9D</option>
                        <option value="9E">9E</option>
                        <option value="9F">9F</option>
                        <option value="9G">9G</option>
                        <option value="9H">9H</option>
                        <option value="9I">9I</option>
                        <option value="9J">9J</option>
                    </select>
                </div>
            </div>
        </div>
    </div>    
    <div class="row">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" style="overflow-x: auto;">
            <br>
            <table id="dataTable" class="table table-striped table-bordered nowrap" style="width:100%"></table>
            <br />
            <br />
            <p id="passingGrade"></p>
        </div>
    </div>
            <!-- Modal Form -->
            <div class="modal fade" id="myModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="myModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-lg modal-dialog-scrollable">
                    <div class="modal-content">
            <!-- Modal Header -->
            <div class="modal-header">
                <h5 class="modal-title" id="myModalLabel">Form Input-Edit</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" onclick="clearForm();"></button>
            </div>
            <!-- Modal Body -->
            <div class="modal-body">
                <form id="myForm">
                    <div class="container">
                        <!-- Row 1 -->
                        <div class="row mb-3">
                            <div class="col-md-3">
                                <label for="ID" class="form-label">ID:</label>
                                <input id="ID" name="ID" class="form-control form-control-sm" readonly>
                            </div>
                            <div class="col-md-3">
                                <label for="Nama" class="form-label">Nama:</label>
                                <input type="text" id="Nama" name="Nama" class="form-control form-control-sm">
                            </div>
                            <div class="col-md-3">
                                <label for="Kelas" class="form-label">Kelas:</label>
                                <select id="Kelas" name="Kelas" class="form-select form-select-sm">
                                    <option value="" disabled selected>Select Kelas</option>
                                    <!-- 7A to 7J -->
                                    <option value="7A">7A</option>
                                    <option value="7B">7B</option>
                                    <option value="7C">7C</option>
                                    <option value="7D">7D</option>
                                    <option value="7E">7E</option>
                                    <option value="7F">7F</option>
                                    <option value="7G">7G</option>
                                    <option value="7H">7H</option>
                                    <option value="7I">7I</option>
                                    <option value="7J">7J</option>
                                    <!-- 8A to 8J -->
                                    <option value="8A">8A</option>
                                    <option value="8B">8B</option>
                                    <option value="8C">8C</option>
                                    <option value="8D">8D</option>
                                    <option value="8E">8E</option>
                                    <option value="8F">8F</option>
                                    <option value="8G">8G</option>
                                    <option value="8H">8H</option>
                                    <option value="8I">8I</option>
                                    <option value="8J">8J</option>
                                    <!-- 9A to 9J -->
                                    <option value="9A">9A</option>
                                    <option value="9B">9B</option>
                                    <option value="9C">9C</option>
                                    <option value="9D">9D</option>
                                    <option value="9E">9E</option>
                                    <option value="9F">9F</option>
                                    <option value="9G">9G</option>
                                    <option value="9H">9H</option>
                                    <option value="9I">9I</option>
                                    <option value="9J">9J</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label for="PPDB" class="form-label">PPDB:</label>
                                <input type="text" id="PPDB" name="PPDB" class="form-control form-control-sm">
                            </div>
                        </div>

                        <!-- Row 2 -->
                        <div class="row mb-3">
                            <div class="col-md-3">
                                <label for="LKS_Ga_7" class="form-label">LKS_Ga_7:</label>
                                <input type="text" id="LKS_Ga_7" name="LKS_Ga_7" class="form-control form-control-sm">
                            </div>
                            <div class="col-md-3">
                                <label for="LKS_Ge_7" class="form-label">LKS_Ge_7:</label>
                                <input type="text" id="LKS_Ge_7" name="LKS_Ge_7" class="form-control form-control-sm">
                            </div>
                            <div class="col-md-3">
                                <label for="Smst_Ga_7" class="form-label">Smst_Ga_7:</label>
                                <input type="text" id="Smst_Ga_7" name="Smst_Ga_7" class="form-control form-control-sm">
                            </div>
                            <div class="col-md-3">
                                <label for="Smst_Ge_7" class="form-label">Smst_Ge_7:</label>
                                <input type="text" id="Smst_Ge_7" name="Smst_Ge_7" class="form-control form-control-sm">
                            </div>
                        </div>

                        <!-- Row 3 -->
                        <div class="row mb-3">
                            <div class="col-md-3">
                                <label for="LKS_Ga_8" class="form-label">LKS_Ga_8:</label>
                                <input type="text" id="LKS_Ga_8" name="LKS_Ga_8" class="form-control form-control-sm">
                            </div>
                            <div class="col-md-3">
                                <label for="LKS_Ge_8" class="form-label">LKS_Ge_8:</label>
                                <input type="text" id="LKS_Ge_8" name="LKS_Ge_8" class="form-control form-control-sm">
                            </div>
                            <div class="col-md-3">
                                <label for="Smst_Ga_8" class="form-label">Smst_Ga_8:</label>
                                <input type="text" id="Smst_Ga_8" name="Smst_Ga_8" class="form-control form-control-sm">
                            </div>
                            <div class="col-md-3">
                                <label for="Smst_Ge_8" class="form-label">Smst_Ge_8:</label>
                                <input type="text" id="Smst_Ge_8" name="Smst_Ge_8" class="form-control form-control-sm">
                            </div>
                        </div>

                        <!-- Row 4 -->
                        <div class="row mb-3">
                            <div class="col-md-3">
                                <label for="LKS_Ga_9" class="form-label">LKS_Ga_9:</label>
                                <input type="text" id="LKS_Ga_9" name="LKS_Ga_9" class="form-control form-control-sm">
                            </div>
                            <div class="col-md-3">
                                <label for="LKS_Ge_9" class="form-label">LKS_Ge_9:</label>
                                <input type="text" id="LKS_Ge_9" name="LKS_Ge_9" class="form-control form-control-sm">
                            </div>
                            <div class="col-md-3">
                                <label for="Smst_Ga_9" class="form-label">Smst_Ga_9:</label>
                                <input type="text" id="Smst_Ga_9" name="Smst_Ga_9" class="form-control form-control-sm">
                            </div>
                            <div class="col-md-3">
                                <label for="AM" class="form-label">AM:</label>
                                <input type="text" id="AM" name="AM" class="form-control form-control-sm">
                            </div>
                        </div>

                        <!-- Additional Fields in Row 4 -->
                        <div class="row mb-3">
                            <div class="col-md-3">
                                <label for="Wisuda" class="form-label">Wisuda:</label>
                                <input type="text" id="Wisuda" name="Wisuda" class="form-control form-control-sm">
                            </div>
                            <div class="col-md-3">
                                <label for="Tanggungan_Tambahan" class="form-label">Tanggungan_Tambahan:</label>
                                <input type="text" id="Tanggungan_Tambahan" name="Tanggungan_Tambahan" class="form-control form-control-sm">
                            </div>
                            <div class="col-md-3">
                                <label for="Rincian" class="form-label">Rincian:</label>
                                <input type="text" id="Rincian" name="Rincian" class="form-control form-control-sm">
                            </div>
                            <div class="col-md-3">
                                <label for="Bayar" class="form-label">Bayar:</label>
                                <input type="text" id="Bayar" name="Bayar" class="form-control form-control-sm">
                            </div>
                        </div>

                        <!-- Final Row for Remaining Fields -->
                        <div class="row mb-3">
                            <div class="col-md-3">
                                <label for="Saldo_PIP" class="form-label">Saldo_PIP:</label>
                                <input type="text" id="Saldo_PIP" name="Saldo_PIP" class="form-control form-control-sm">
                            </div>
                            <div class="col-md-3">
                                <label for="Sisa_PIP" class="form-label">Sisa_PIP:</label>
                                <input type="text" id="Sisa_PIP" name="Sisa_PIP" class="form-control form-control-sm">
                            </div>
                            <div class="col-md-3">
                                <label for="Angkatan" class="form-label">Angkatan:</label>
                                <select id="Angkatan" name="Angkatan" class="form-select form-select-sm">
                                    <option value="" disabled selected>Select Angkatan</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label for="Status" class="form-label">Status:</label>
                                <select id="Status" name="Status" class="form-select form-select-sm">
                                    <option value="" disabled selected>Select Status</option>
                                    <option value="Baru">Baru</option>
                                    <option value="Mutasi7">Mutasi7</option>
                                    <option value="Mutasi8">Mutasi8</option>
                                    <option value="Mutasi9">Mutasi9</option>
                                </select>
                            </div>
                        </div>

                        <!-- Optional Row for Additional Fields -->
                        <div class="row mb-3">
                            <div class="col-md-3">
                                <label for="Ket_Mutasi" class="form-label">Ket_Mutasi:</label>
                                <select id="Ket_Mutasi" name="Ket_Mutasi" class="form-select form-select-sm">
                                    <option value="" disabled selected>Select an option</option>
                                    <option value="Ganjil">Ganjil</option>
                                    <option value="Genap">Genap</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label for="Pernah_Tidak_Naik_Kelas" class="form-label">Pernah_Tidak_Naik_Kelas:</label>
                                <select id="Pernah_Tidak_Naik_Kelas" name="Pernah_Tidak_Naik_Kelas" class="form-select form-select-sm">
                                    <option value="" disabled selected>Select an option</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                </select>
                            </div>
                            <!-- Empty columns if needed -->
                            <div class="col-md-3"></div>
                            <div class="col-md-3"></div>
                        </div>
                    </div>
                </form>
            </div>

<!-- Modal Footer -->
<div class="modal-footer">
    <button type="button" class="btn btn-primary" onclick="updateForm()">Update</button>
    <button type="button" class="btn btn-success" onclick="printReceipt()">Kwitansi</button>
    <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>

<script>
function updateForm() {
// Add your update logic here
console.log("Update button clicked");
}

function printReceipt() {
// Add your receipt printing logic here
console.log("Kwitansi button clicked");
}
</script>

    <style>
        .title-header {
    font-family: 'Roboto', sans-serif; /* Example of a modern font */
    font-size: 25px;
    font-weight: bold;
    text-align: center;
    margin-bottom: 20px;
    color: #333; /* Adjust color as needed */
}

        body {
            background-image: url('https://alutsmani.github.io/Pattern.jpg');
            background-repeat: repeat;
            background-attachment:scroll;
            background-size: contain;
        }
        .cool-box {
            background: linear-gradient(320deg, #000000, #0502b4);
            border: 2px solid #ffffff;
            border-radius: 10px; /* Sudut sudut kotak */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5); /* Bayangan */
            padding: 20px; /* Ukuran padding yang benar */
            width: 80%; /* Lebar kotak */
            max-width: 300px;
            margin: auto; /* Pusatkan kotak secara horizontal */
            flex-direction: column;
            align-items: center;
            position:static;
            overflow: hidden;
            transition: max-height 1s ease-out, top 0.8s ease-in-out;
        }


        .cool-box input {
            font-weight: bold;
            font-size:medium;
        }


        .Heading3 {
            text-align: center;
            margin-bottom: 20px;
            font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
            color:#0502b4;
        }

        .Biodata{
            background-color: #ffffff;
            align-items: center;
            margin: auto;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            margin-top: 15px;
            max-width: 400px;
            
            transition: opacity 0.5s;
        }

        

        .visible {
            display: block;
            opacity: 1;
        }

        .hidden {
            display: none !important;
            opacity: 0;
        }


        .TTL{
            background-color: #dadada00;
            display:inline-flex;
            justify-content:space-between; /* Untuk memberikan jarak antara elemen-elemen di dalam .ttl */
        }

        .TTL label{
            width: 100px;
        }

        



        /* HTML: <div class="loader"></div> */
        #loader {
            width: 100%;
            height: 20px;
            background: 
                linear-gradient(#07971a 0 0) left -40px top 0/40px 20px,
                linear-gradient(#ddd 0 0) center/100% 50%; 
            background-repeat: no-repeat;
            animation: l5 1s infinite linear;
            }
            @keyframes l5 {
            100% {background-position: right -40px top 0,center}
        }

        /* Gaya mode terang untuk semua dropdown */
        select::-webkit-calendar-picker-indicator {
            color: #0a0a0a; /* Warna teks pada mode gelap */
            background-color: #f7f7f7; /* Warna latar belakang pada mode gelap */
        }

        /* Gaya mode gelap untuk semua dropdown */
        @media (prefers-color-scheme: dark) {
            select::-webkit-calendar-picker-indicator {
                color: #fff; /* Warna teks pada mode gelap */
                background-color: #242424; /* Warna latar belakang pada mode gelap */
            }
        }

        #Judul{
            font-weight: bold;
        }

        #example {
            background-color: white; /* Memberikan latar belakang putih pada tabel */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* Menambahkan bayangan pada tabel */
            
        }

    
    </style>
    
 	<!-- DataTable  -->
     <div class="container-fluid">
		<?!= include('DataTable'); ?> <!-- See DataTable.html File -->
	</div>
    
    <script src = "https://code.jquery.com/jquery-3.5.1.js" ></script>
    <script src = "https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.2.0/js/bootstrap.bundle.min.js" > </script> 
    <script src = "https://cdn.datatables.net/1.13.3/js/jquery.dataTables.min.js" > </script> 
    <script src = "https://cdn.datatables.net/1.13.3/js/dataTables.bootstrap5.min.js" > </script> 
    <script src = "https://cdn.datatables.net/responsive/2.4.0/js/dataTables.responsive.min.js" > </script> 
    <script src = "https://cdn.datatables.net/responsive/2.4.0/js/responsive.bootstrap5.min.js" > </script>

    <script>
        function onReload() {
            var baseUrl = "https://script.google.com/macros/s/AKfycbwjVBOZXgkq9hmXBdhYHemrddW32Hr-z_HmLB2fJwf3sml5PUiER4KKXGbHoCHWf3b2/exec?sh=Data";
    
            var tableColumns = [
                { title: "ID", data: "ID" },
                { title: "Nama", data: "Nama" },
                { title: "Kelas", data: "Kelas" },
                { title: "PPDB = Rp", data: "PPDB" },
                { title: "LKS Ganjil 7 = Rp", data: "LKS_Ga_7" },
                { title: "LKS Genap 7 = Rp", data: "LKS_Ge_7" },
                { title: "Smst Ganjil 7 = Rp", data: "Smst_Ga_7" },
                { title: "Smst Genap 7 = Rp", data: "Smst_Ge_7" },
                { title: "LKS Ganjil 8 = Rp", data: "LKS_Ga_8" },
                { title: "LKS Genap 8 = Rp", data: "LKS_Ge_8" },
                { title: "Smst Ganjil 8 = Rp", data: "Smst_Ga_8" },
                { title: "Smst Genap 8 = Rp", data: "Smst_Ge_8" },
                { title: "LKS Ganjil 9 = Rp", data: "LKS_Ga_9" },
                { title: "LKS Genap 9 = Rp", data: "LKS_Ge_9" },
                { title: "Smst Ganjil 9 = Rp", data: "Smst_Ga_9" },
                { title: "AM = Rp", data: "AM" },
                { title: "Wisuda = Rp", data: "Wisuda" },
                { title: "Tanggungan Tambahan = Rp", data: "Tanggungan_Tambahan" },
                { title: "Rincian =", data: "Rincian" },
                { title: "Bayar = Rp", data: "Bayar" },
                { title: "Saldo PIP = Rp", data: "Saldo_PIP" },
                { title: "Sisa PIP = Rp", data: "Sisa_PIP" },
                { title: "Angkatan = Rp", data: "Angkatan" },
                { title: "Status = Rp", data: "Status" },
                { title: "Ketertangan Mutasi = Rp", data: "Ket_Mutasi" },
                { title: "Pernah Tidak Naik Kelas = Rp", data: "Pernah_Tidak_Naik_Kelas" },
                {
    title: "Aksi",
    data: null,
    render: function(data, type, row) {
        return `
            <button class="btn btn-primary btn-sm" onclick="editRow('${row.ID}')">
                <i class="fas fa-pencil-alt"></i> 
            </button>
            <button class="btn btn-danger btn-sm" onclick="deleteRow('${row.ID}')">
                <i class="fas fa-trash"></i> 
            </button>
        `;
    }
}

            ];
    
            var table = $("#dataTable").DataTable({
                ajax: {
                    url: baseUrl,
                    error: function(xhr, error, thrown) {
                        console.error("Error:", error);
                        alert("Terjadi kesalahan saat memuat data. Silakan coba lagi.");
                    }
                },
                columns: tableColumns,
                rowId: "ID",
                columnDefs: [
                    { targets: [1, 2, 26], className: 'all' },
                    { targets: [0], visible: false, searchable: true }
                ],
                destroy: true,
                responsive: true,
                select: true,
                stateSave: true,
                ordering: true,
                order: [[0, 'desc']],
                pageLength: 5,
                lengthMenu: [
                    [5, 10, 25, 50, 100, -1],
                    ['5', '10', '25', '50', '100', 'All']
                ],
                initComplete: function() {
                    this.api().columns().every(function() {
                        var column = this;
                        // Add any column-specific initialization logic here
                    });
                }
            });
    
            // Event listener untuk dropdown filter
            $('#kelasMTs').change(function() {
                var val = $(this).val();
                table.column(2).search(val === "Semua" ? '' : val).draw();
            });
        }
    
        function submitUpdate() {
            var formData = new FormData(document.getElementById('updateForm'));
            var data = {};
            formData.forEach((value, key) => { data[key] = value; });

            fetch('https://script.google.com/macros/s/AKfycbwjVBOZXgkq9hmXBdhYHemrddW32Hr-z_HmLB2fJwf3sml5PUiER4KKXGbHoCHWf3b2/exec', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded'
                },
                body: new URLSearchParams({
                    action: 'Update',
                    id: data.ID,
                    sh: 'Data', // Replace with your actual sheet name
                    ...data
                })
            })
            .then(response => response.text())
            .then(result => {
                console.log(result); // Handle result here (e.g., show a success message)
                $('#updateModal').modal('hide'); // Hide modal after update
            })
            .catch(error => console.error('Error:', error));
        }

        function deleteRow(id) {
            const password = prompt("Masukkan sandi untuk menghapus data:");

    if (password === "170899") { // Ganti "passwordAnda" dengan sandi yang sebenarnya
            $.ajax({
                url: 'https://script.google.com/macros/s/AKfycbwjVBOZXgkq9hmXBdhYHemrddW32Hr-z_HmLB2fJwf3sml5PUiER4KKXGbHoCHWf3b2/exec',
                type: 'GET', // Or 'POST' based on your API design
                data: {
                    action: 'Delete',
                    id: id,
                    sh: 'Data'
                },
                success: function(response) {
                    console.log('Data successfully deleted');
                    $("#dataTable").DataTable().ajax.reload(); // Refresh the table
                },
                error: function(xhr, status, error) {
                    console.error('Error deleting data:', error);
                }
            
            });
        }
    }
    
    function editRow(id) {
    const password = prompt("Masukkan sandi untuk mengedit data:");

    if (password === "1708") { // Ganti "1708" dengan sandi yang sebenarnya
        var table = $("#dataTable").DataTable();
        var row = table.row("#" + id);
        var data = row.data();

        if (data) {
            // Jika data ditemukan, tampilkan modal dan isi form dengan data yang sesuai
            $("#myModal").modal("show");
            $("#ID").val(data.ID || '');
            $("#Nama").val(data.Nama || '');
            $("#Kelas").val(data.Kelas || '');
            $("#PPDB").val(data.PPDB || '');
            $("#LKS_Ga_7").val(data.LKS_Ga_7 || '');
            $("#LKS_Ge_7").val(data.LKS_Ge_7 || '');
            $("#Smst_Ga_7").val(data.Smst_Ga_7 || '');
            $("#Smst_Ge_7").val(data.Smst_Ge_7 || '');
            $("#LKS_Ga_8").val(data.LKS_Ga_8 || '');
            $("#LKS_Ge_8").val(data.LKS_Ge_8 || '');
            $("#Smst_Ga_8").val(data.Smst_Ga_8 || '');
            $("#Smst_Ge_8").val(data.Smst_Ge_8 || '');
            $("#LKS_Ga_9").val(data.LKS_Ga_9 || '');
            $("#LKS_Ge_9").val(data.LKS_Ge_9 || '');
            $("#Smst_Ga_9").val(data.Smst_Ga_9 || '');
            $("#AM").val(data.AM || '');
            $("#Wisuda").val(data.Wisuda || '');
            $("#Tanggungan_Tambahan").val(data.Tanggungan_Tambahan || '');
            $("#Rincian").val(data.Rincian || '');
            $("#Bayar").val(data.Bayar || '');
            $("#Saldo_PIP").val(data.Saldo_PIP || '');
            $("#Sisa_PIP").val(data.Sisa_PIP || '');
            $("#Angkatan").val(data.Angkatan || '');
            $("#Status").val(data.Status || '');
            $("#Ket_Mutasi").val(data.Ket_Mutasi || '');
            $("#Pernah_Tidak_Naik_Kelas").val(data.Pernah_Tidak_Naik_Kelas || '');
        } else {
            console.error('Data not found for row with ID:', id);
        }
    } else {
        // Jika sandi salah, tampilkan peringatan dan jangan tampilkan modal
        alert("Sandi salah, Anda tidak dapat mengedit data ini.");
    }
}

        
    
        function Jumlahkan() {
            var table = document.getElementById("dataTable");
            var total = 0;
    
            for (var i = 1; i < table.rows.length; i++) {
                var cellValue = parseFloat(table.rows[i].cells[19].innerText); // Assuming the 20th column contains numeric values
                if (!isNaN(cellValue)) {
                    total += cellValue;
                }
            }
    
            var formattedTotal = "Rp " + total.toLocaleString('id-ID');
            document.getElementById("TotalSemua").innerText = ": " + formattedTotal;
        }
    
        $(document).ready(function() {
            onReload();
            
            $('#myForm').on('submit', function(e) {
            e.preventDefault(); // Prevent the default form submission

            var id = $('#ID').val();
            var nama = $('#Nama').val();
            var ppdb = $('#PPDB').val();

            $.ajax({
                url: 'https://script.google.com/macros/s/AKfycbwjVBOZXgkq9hmXBdhYHemrddW32Hr-z_HmLB2fJwf3sml5PUiER4KKXGbHoCHWf3b2/exec', // Update with your URL
                type: 'POST', // Or 'GET' based on your API design
                data: {
                    action: 'Update', // Indicate the action to perform
                    ID: id,
                    Nama: nama,
                    PPDB: ppdb,
                    sh: 'Data' // Adjust this to your specific sheet name if necessary
                },
                success: function(response) {
                    // Handle success - maybe show a success message or close the modal
                    console.log('Data successfully updated');
                    $("#myModal").modal("hide"); // Close the modal
                    $("#dataTable").DataTable().ajax.reload(); // Refresh the table
                },
                error: function(xhr, status, error) {
                    // Handle error
                    console.error('Error updating data:', error);
                }
            });
        });
            
        });
    
        
    </script>
    

  </body>
</html>

