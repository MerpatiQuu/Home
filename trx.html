<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kasir MerpatiQuu</title>
    <!-- Bootstrap CSS -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <!-- DataTables CSS -->
    <link href="https://cdn.datatables.net/1.10.21/css/dataTables.bootstrap4.min.css" rel="stylesheet">
    <!-- Font Awesome CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.10.3/font/bootstrap-icons.min.css" rel="stylesheet">
    <link rel="icon" href="https://github.com/MerpatiQuu/M/blob/main/WhatsApp%20Image%202024-09-11%20at%2014.38.17.jpeg?raw=true" type="image/x-icon" />
    <meta property="og:image" content="https://github.com/MerpatiQuu/M/blob/main/WhatsApp%20Image%202024-09-11%20at%2014.38.17.jpeg?raw=true" />
    <style>
    /* Menu Icon Section */
    .menu-icon {
    display: flex; /* Align items horizontally */
    align-items: center; /* Center items vertically */
    gap: 10px; /* Space between logo and text */
    cursor: pointer; /* Pointer cursor on hover */
    padding: 10px 15px; /* Padding around the menu icon */
    background-color: #ffffff; /* White background for clean look */
    transition: background-color 0.3s, box-shadow 0.3s, transform 0.3s; /* Smooth transition for hover effects */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* Subtle shadow effect */
}

.menu-icon:hover {
    background-color: #fb64e7; /* Slightly darker background on hover */
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2); /* Increased shadow on hover */
    transform: scale(1); /* Slightly enlarge on hover */
}

.menu-icon .menu-icon-toggle {
    font-size: 1.5rem; /* Larger icon for emphasis */
    color: #007bff; /* Blue color for the icon */
}
    .menu-icon img {
      width: 40px;
      height: 40px;
      border-radius: 50%; /* Membuat logo bulat */
      margin-right: 10px; /* Spasi antara logo dan ikon menu */
    }

    /* Menu Content Section */
    .menu-content {
      display: none;
      margin-top: 10px;
      background-color: white; /* Latar belakang putih */
      padding: 10px;
      border-radius: 5px;
    }

    .menu-content ul {
      list-style-type: none;
      padding: 0;
      margin: 0;
    }

    .menu-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
    }

    .menu-item {
      display: flex;
      align-items: center;
      color: #000; /* Warna teks hitam */
    }

    .menu-item i {
      margin-right: 1px;
      font-size: 24px;
    }

    .menu-item a {
      text-decoration: none;
      color: rgb(20, 18, 18); /* Warna teks putih */
      font-size: 10px;
      transition: color 0.3s ease;
    }

    /* Hover efek untuk setiap item menu */
    .menu-item a:hover {
      color: rgb(251, 122, 195);
      opacity: 0.8;
    }

    /* Warna untuk setiap ikon menu */
    .home i {
      color: #007bff; /* Ikon biru untuk Home */
    }

    .kasir i {
      color: #28a745; /* Ikon hijau untuk Kasir */
    }

    .gudang i {
      color: #ffc107; /* Ikon kuning untuk Gudang */
    }

    .pengumuman i {
      color: #17a2b8; /* Ikon biru muda untuk Pengumuman */
    }

    .absen i {
      color: #ff5722; /* Ikon oranye untuk Absen */
    }

    .laporan i {
      color: #6f42c1; /* Ikon ungu untuk Laporan */
    }
    .menu-text {
    font-size: 1.25rem; /* Larger font size for emphasis */
    font-weight: 700; /* Bold text */
    color: #333; /* Dark grey color for text */
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.15); /* Subtle text shadow */
    letter-spacing: 1px; /* Increased letter spacing */
    transition: color 0.3s; /* Smooth color transition on hover */
}

.menu-icon:hover .menu-text {
    color: #fcfcfd; /* Change text color on hover */
}
/* Logo and Header Title */
.logo-container {
    text-align: center;
    margin: 0;
    padding: 0;
}

.logo-container img {
    max-width: 60px; /* Menyesuaikan ukuran logo pada perangkat kecil */
    height: auto;
    background: none;
}

.header-title {
    text-align: center;
    margin-bottom: 0;
    font-size: 1.5rem; /* Menyesuaikan ukuran font pada perangkat kecil */
    background: linear-gradient(to right, blue, rgb(255, 251, 0));
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
    color: transparent;
    font-weight: bold;
}

/* Buttons */
.btn-custom {
    padding: 1px 1px; /* Menambah padding untuk tombol agar lebih mudah di klik pada perangkat kecil */
    font-size: 10px; /* Menyesuaikan ukuran font tombol */
}

.btn-no-bg {
    background: none;
    border: none;
    padding: 0;
    margin: 0;
}

.plus-icon {
    font-size: 0.575rem;
    padding: 0rem;
    border: 1px solid #007bff;
    color: #007bff;
    background-color: transparent;
}

.ml-1 {
    margin-left: 5px;
}

.btn-no-bg:hover .plus-icon {
    background-color: #007bff;
    color: #fff;
}

.btn-print {
    font-size: 0.575rem;
    padding: 0rem;
    border: 1px solid #007bff;
    color: #007bff;
    background-color: transparent;
}

.btn-print:hover {
    background-color: #007bff;
    color: #fff;
}
/* Style for the button with no background */
.btn-no-bg {
    background: transparent; /* Remove background color */
    border: none; /* Remove border */
    padding: 0; /* Remove padding */
    margin: 0; /* Remove margin */
    font-size: 1rem; /* Adjust font size as needed */
    cursor: pointer; /* Change cursor to pointer to indicate it's clickable */
}

/* Optional: Style the button icon */
.btn-no-bg .fa-trash {
    color: #dc3545; /* Font Awesome color for danger (red) */
    font-size: 1rem; /* Adjust icon size if needed */
}

/* Optional: Add a hover effect if desired */
.btn-no-bg:hover {
    opacity: 0.8; /* Slightly fade the button on hover */
}

/* Tables */
.table {
    font-size: 0.875rem; /* Menyesuaikan ukuran font tabel */
}
/* Pastikan tabel tidak memiliki padding atau margin */
#transactionTable {
    width: 100%; /* Tabel menempati seluruh lebar */
    border-collapse: collapse; /* Menghilangkan jarak antar border */
    border-spacing: 0; /* Pastikan tidak ada jarak antar sel */
    border: none; /* Menghilangkan border default */
}

/* Hilangkan padding dan margin dari sel tabel dan baris */
#transactionTable th, #transactionTable td {
    padding: 0; /* Hilangkan padding */
    margin: 0;  /* Hilangkan margin */
    border: none; /* Menghilangkan border */
    text-align: left; /* Rata kiri untuk teks */
    vertical-align: middle; /* Konten di tengah secara vertikal */
}

/* Atur tampilan header tabel */
#transactionTable thead th {
    padding: 0; /* Hilangkan padding */
    margin: 0;  /* Hilangkan margin */
    border-bottom: none; /* Hilangkan border bawah header jika perlu */
    font-weight: bold; /* Buat header tebal (opsional) */
    vertical-align: middle; /* Pastikan header vertikal di tengah */
    text-align: left; /* Rata kiri untuk header */
}

/* Hilangkan padding dan margin dari wrapper tabel */
#transactionTable_wrapper {
    margin: 0; /* Hilangkan margin wrapper */
    padding: 0; /* Hilangkan padding wrapper */
}

/* Hilangkan spasi di sekitar teks dalam sel */
#transactionTable p.itemtext {
    margin: 0; /* Hilangkan margin pada teks dalam tabel */
    padding: 0; /* Hilangkan padding pada teks dalam tabel */
    font-size: 0.875rem; /* Atur ukuran font agar lebih kecil */
}

/* Atur tampilan ikon */
#transactionTable .fas {
    font-size: 0.8rem; /* Ukuran ikon lebih kecil */
}

/* Atur tombol hapus lebih kecil dan rapat */
#transactionTable .btn-no-bg {
    padding: 0; /* Hilangkan padding */
    margin: 0; /* Hilangkan margin */
    line-height: 1; /* Line-height lebih rendah untuk tombol */
    cursor: pointer; /* Tampilkan pointer pada hover */
}

/* Pastikan baris tabel rapat */
#transactionTable tr.service {
    line-height: 1.1; /* Line-height lebih rendah untuk baris */
    margin: 0; /* Hilangkan margin */
    padding: 0; /* Hilangkan padding */
}

/* Pastikan tabel di footer juga tidak memiliki jarak */
#transactionTable tfoot td {
    padding: 0; /* Hilangkan padding di footer */
    margin: 0; /* Hilangkan margin di footer */
}
.custom-title {
    font-size: 1rem; /* Atur ukuran font sesuai kebutuhan */
    margin: 0;
}
.custom-label {
    font-size: 0.5rem; /* Atur ukuran font sesuai kebutuhan */
}
.total {
    margin-top: 20px;
    font-weight: bold;
}

.total-section {
    display: flex;
    flex-direction: column; /* Menyesuaikan agar total section tampil vertikal pada perangkat kecil */
    align-items: stretch; /* Menyesuaikan agar form-group mengisi lebar penuh */
    margin-top: 1px;
}

.total-section .form-group {
    margin-bottom: 1px;
}

.payment-input, .change-display {
    margin-left: 0; /* Menghilangkan margin-left pada perangkat kecil */
    margin-bottom: 1px; /* Menambahkan margin-bottom untuk jarak antar elemen */
}

.payment-input input, .change-display input {
    width: 100%; /* Menyesuaikan lebar input agar penuh pada perangkat kecil */
    padding: 5px;
    font-size: 10px;
}

/* Form Controls */
.form-control {
    font-size: 10px; /* Menyesuaikan ukuran font formulir */
    padding: 5px; /* Menambah padding untuk kenyamanan */
}

label {
    font-weight: bold;
}
/* Base styles for the modal */
.modal-sm {
    max-width: 100%; /* Full width on small devices */
    margin: 0; /* Remove margin to utilize full screen width on mobile */
}

/* Modal content styling */
.modal-sm .modal-content {
    font-size: 0.75rem; /* Adjust font size in modal */
}

/* Input and button styling */
.modal-sm .form-control, 
.modal-sm .btn {
    font-size: 0.75rem; /* Adjust font size for input and buttons */
    padding: 0.5rem;
}

/* Styles for mobile devices */
@media (max-width: 767px) {
    .modal-sm {
        max-width: 90%; /* Reduce max width on small screens to avoid overflow */
        margin: 0 auto; /* Center the modal horizontally */
    }
}

/* Styles for larger devices (desktops) */
@media (min-width: 768px) {
    .modal-sm {
        max-width: 800px; /* Set a maximum width for larger screens */
        margin: 1.5rem auto; /* Center the modal and add vertical margin */
    }
    
    .modal-sm .modal-content {
        font-size: 0.875rem; /* Slightly larger font size for better readability on larger screens */
    }
    
    .modal-sm .form-control, 
    .modal-sm .btn {
        font-size: 0.875rem; /* Slightly larger font size for inputs and buttons */
        padding: 0.75rem; /* Increase padding for better spacing */
    }
}

/* Additional adjustments for modal body layout */
@media (min-width: 768px) {
    .modal-sm .modal-body {
        display: grid;
        grid-template-columns: repeat(2, 1fr); /* Create two columns */
        gap: 1rem; /* Space between items */
    }

    .modal-sm .modal-body .form-group {
        margin-bottom: 1rem; /* Space between form groups */
    }
    
    .modal-sm .form-row {
        display: contents; /* Let grid layout handle the row arrangement */
    }

    .modal-sm .form-row .form-group {
        margin: 0; /* Remove default margins */
    }
}

.modal-sm .btn-no-bg span {
    margin-left: 5px; /* Space between icon and text */
    font-size: 1rem;  /* Adjust font size */
    color: #007bff;   /* Text color matching the icon */
}

/* Ensure proper alignment of icon and text */
.modal-sm .btn-no-bg {
    display: inline-flex; /* Ensure icon and text are aligned */
    align-items: center;  /* Vertically align text and icon */
}
/* CSS untuk menyembunyikan elemen dalam modal */
.modal-body .hidden-in-modal {
    display: none; /* Atau gunakan visibility: hidden; jika Anda ingin elemen tetap mengambil ruang */
}

/* Print Styles */
@media print {
    @page {
        size: 58mm auto;
        margin: 0; /* Menghilangkan margin atas dan bawah */
    }
    
    body * {
        visibility: hidden;
    }

    #transactionTable, #transactionTable * {
        visibility: visible;
    }

    .print-header {
        position: absolute;
        top: 0;
        left: 0;
        width: 58mm;
        text-align: center;
        font-size: 14px;
        margin: 0; /* Menghilangkan margin bawah */
    }

    .print-header img {
        width: 50px;
        height: auto;
    }

    #transactionTable {
        position: absolute;
        left: 0;
        top: 0; /* Mengatur agar tabel langsung tampil di bagian atas */
        width: 58mm;
        font-size: 12px;
        line-height: 1.2;
    }

    #transactionTable th, #transactionTable td {
        padding: 5px;
        border: 1px solid #000;
    }

    #grandTotalDisplay {
        font-size: 12px;
        text-align: left;
        margin: 0; /* Menghilangkan margin atas dan bawah */
    }

    .btn-print {
        display: none;
    }

    #transactionTable th:nth-child(6), #transactionTable td:nth-child(6) {
        display: none;
    }
    .itemtext {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 100%;
            }
}

/* General Styles */
.print-header {
    display: none;
}

table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.6em;
}

td, th {
    border: none;
    padding: 0;
    margin: 0;
    font-size: inherit;
}

.tableitem {
    padding: 0;
    margin: 0;
}

.hide-column {
    display: none;
}

.combined-content {
    margin: 0;
    padding: 0;
}

.btn {
    padding: 2px 4px;
    font-size: 0.8em;
}

/* Media Queries for Mobile */
@media (max-width: 768px) {
    .row {
        flex-direction: column; /* Menyusun kolom secara vertikal pada perangkat kecil */
    }

    .col-md-6 {
        width: 100%; /* Menyusun kolom secara penuh pada perangkat kecil */
    }

    .total-section {
        flex-direction: column; /* Mengatur flex direction ke column untuk total-section */
    }

    .btn-custom, .btn-print {
        font-size: 14px; /* Menyesuaikan ukuran font untuk tombol pada perangkat kecil */
        padding: 8px 12px; /* Menambah padding tombol agar lebih mudah di klik */
    }

    .logo-container img {
        max-width: 50px; /* Menyesuaikan ukuran logo pada perangkat kecil */
    }

    .header-title {
        font-size: 1.2rem; /* Menyesuaikan ukuran font judul pada perangkat kecil */
    }
}

@media (max-width: 576px) {
    .header-title {
        font-size: 1rem; /* Menyesuaikan ukuran font judul pada perangkat sangat kecil */
    }
}
        /* Cool infinite background scrolling animation.
 * Twitter: @kootoopas
 */
/* Exo thin font from Google. */
/* Background data (Original source: https://subtlepatterns.com/grid-me/) */
/* Animations */
@-webkit-keyframes bg-scrolling-reverse {
  100% {
    background-position: 50px 50px;
  }
}
@-moz-keyframes bg-scrolling-reverse {
  100% {
    background-position: 50px 50px;
  }
}
@-o-keyframes bg-scrolling-reverse {
  100% {
    background-position: 50px 50px;
  }
}
@keyframes bg-scrolling-reverse {
  100% {
    background-position: 50px 50px;
  }
}
@-webkit-keyframes bg-scrolling {
  0% {
    background-position: 50px 50px;
  }
}
@-moz-keyframes bg-scrolling {
  0% {
    background-position: 50px 50px;
  }
}
@-o-keyframes bg-scrolling {
  0% {
    background-position: 50px 50px;
  }
}
@keyframes bg-scrolling {
  0% {
    background-position: 50px 50px;
  }
}
/* Main styles */
body {
  /* img size is 50x50 */
  background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAIAAACRXR/mAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAABnSURBVHja7M5RDYAwDEXRDgmvEocnlrQS2SwUFST9uEfBGWs9c97nbGtDcquqiKhOImLs/UpuzVzWEi1atGjRokWLFi1atGjRokWLFi1atGjRokWLFi1af7Ukz8xWp8z8AAAA//8DAJ4LoEAAlL1nAAAAAElFTkSuQmCC") repeat 0 0;
  -webkit-animation: bg-scrolling-reverse 0.92s infinite;
  /* Safari 4+ */
  -moz-animation: bg-scrolling-reverse 0.92s infinite;
  /* Fx 5+ */
  -o-animation: bg-scrolling-reverse 0.92s infinite;
  /* Opera 12+ */
  animation: bg-scrolling-reverse 0.92s infinite;
  /* IE 10+ */
  -webkit-animation-timing-function: linear;
  -moz-animation-timing-function: linear;
  -o-animation-timing-function: linear;
  animation-timing-function: linear;
}
.card-body {
            display: flex;
            flex-direction: column; /* Default to column for vertical stacking */
        }
        .header-row {
            display: flex;
            align-items: center; /* Vertikal alignment */
            justify-content: space-between; /* Spasi antara elemen */
            margin-bottom: 0px; /* Jarak bawah untuk pemisah dari elemen lainnya */
        }
.btn-refresh {
            align-items: center;
            background-color: #0a83fc;
            color: rgb(14, 0, 0);
            border: 1px solid #007bff;
            border-radius: 4px;
            padding: 2px 10px;
            font-size: 10px;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s ease;
            background-color: transparent;
        }
        .btn-refresh:hover {
            background-color: #3796fc;
            color: #000;
        }
        .btn-refresh i {
            margin: 0;
        }
        .btn-import {
            align-items: center;
            background-color: #13fe13;
            color: rgb(16, 16, 16);
            border: 1px solid #2cfd41;
            border-radius: 4px;
            padding: 3px;
            font-size: 10px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            margin: 0px 0; /* Jarak vertikal dari elemen lain */
            background-color: transparent;
        }
        .btn-import:hover {
            background-color: #e5f50b;
        }
        .btn-import i {
            margin: 0; /* Jarak antara ikon dan tepi tombol */
        }
        #inputExcel {
            display: none; /* Menyembunyikan elemen input asli */
        }
    </style>
</head>
<body>
  <!-- Menu Icon with Logo -->
  <div class="menu-icon" onclick="toggleMenu()">
    <i class="bi bi-list"></i>
    <img src="https://github.com/MerpatiQuu/M/blob/main/WhatsApp%20Image%202024-09-11%20at%2014.38.17.jpeg?raw=true" alt="Menu Logo">
    <span class="menu-text">Toko MerpatiQuu</span> 
</div>

  <!-- Hidden Menu Content -->
  <div class="menu-content" id="menuContent">
    <ul>
      <!-- Row 1: Home, Kasir, Gudang -->
      <div class="menu-row">
        <li class="menu-item home"><i class="bi bi-house-door"></i><a href="index.html">Home</a></li>
        <li class="menu-item kasir"><i class="bi bi-cash"></i><a href="trx.html">Sales Order</a></li>
        <li class="menu-item gudang"><i class="bi bi-box"></i><a href="https://docs.google.com/spreadsheets/d/1jXhP5804xTNqvVObvtZiU5GqUAalcNqs2L6JJfWd-J0/edit?gid=1850812155#gid=1850812155">Gudang</a></li>
      </div>
      
      <!-- Row 2: Pengumuman, Absen, Laporan -->
      <div class="menu-row">
        <li class="menu-item pengumuman"><i class="bi bi-megaphone"></i><a href="pengumuman.html">Pengumuman</a></li>
        <li class="menu-item absen"><i class="bi bi-person-check"></i><a href="absen.html">Absen</a></li>
        <li class="menu-item laporan"><i class="bi bi-file-earmark-text"></i><a href="lapor.html">Laporan</a></li>
      </div>
    </ul>
  </div>
    <div class="container">
<!-- Modal Structure -->
<div class="modal fade modal-sm" id="itemModal" tabindex="-1" role="dialog" aria-labelledby="itemModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="itemModalLabel">Tambah Pembelian</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-row">
                    <div class="form-group">
                        <label for="item">Nama:</label>
                        <input type="text" id="item" class="form-control" placeholder="-" readonly>
                    </div>
                    <div class="form-group">
                        <label for="quantity">Quantity:</label>
                        <input type="number" id="quantity" class="form-control" placeholder="Masukkan jumlah" min="1" value="1">
                    </div>
                    <div class="form-group">
                        <label for="priceType">Jenis:</label>
                        <select id="priceType" class="form-control" onchange="updatePrice()">
                            <option value="pcs">Pcs</option>
                            <option value="pac">Pac</option>
                            <option value="dos">Dos</option>
                            <option value="mm" selected>MM</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="isi">Isi:</label>
                        <input type="number" id="isi" class="form-control" placeholder="-" min="0">
                    </div>
                    <div class="form-group hidden-in-modal">
                        <label for="price">Harga:</label>
                        <input type="number" id="price" class="form-control" placeholder="-" min="0">
                    </div>
                    <div class="form-group">
                        <label for="jumlah">Jumlah:</label>
                        <input type="number" id="jumlah" class="form-control" placeholder="-" min="0" readonly>
                    </div>
                    <div class="form-group">
                        <label for="total">Total:</label>
                        <input type="number" id="total" class="form-control" placeholder="-" min="0" readonly>
                    </div>
                    <div class="form-group d-flex justify-content-center align-items-center">
                        <button class="btn btn-print" onclick="addTransaction()">
                            <i class="fas fa-plus plus-icon" style="color: blue;"></i> Tambah
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="container mt-4">
    <div class="row">
        <!-- Kotak di sebelah kiri -->
        <div class="col-md-4">
            <div class="card">
                <div class="card-body">
                               <!-- Tombol Refresh -->
    <button class="btn-refresh" onclick="refreshPage()">
        Setelah Import, Klik....! <i class="fas fa-sync-alt" style="color: rgb(255, 0, 0);"></i> Refresh
    </button>
        <!-- Input field and button to fetch transaction code -->
        <div style="display: flex; align-items: center;" class="mb-3">
            <select id="transactionSelect" class="form-control" style="margin-right: 10px;" onchange="selectTransactionCode()">
                <option value="">Kode Transaksi</option>
            </select>
            <input type="text" id="searchCode" class="form-control" placeholder="Masukkan Kode Transaksi" aria-label="Transaction Code" style="margin-right: 10px;">
            <span class="btn btn-fetch" onclick="searchTransaction()" style="cursor: pointer;">Fetch</span>
        </div>      
                    <h2 class="custom-title">Daftar Transaksi</h2>        
                                <!-- Dropdown menu -->
            <div class="form-group">
                <label for="nameDropdown" style="margin-bottom: 0; font-size: 10px;">Kasir:</label>
                <select id="nameDropdown" class="form-control" style="font-size: 9px; margin-top: 0; margin-bottom: 0;">
                    <option value="Taufiq">Taufiq</option>
                    <option value="Wafir">Wafir</option>
                    <option value="Wasil">Wasil</option>
                    <option value="Miftah">Miftah</option>
                    <option value="Farhan">Farhan</option>
                    <option value="Ervan">Ervan</option>
                    <option value="Ghazi">Ghazi</option>
                    <option value="Lutfi">Lutfi</option>
                    <option value="Qosim">Qosim</option>
                    <option value="Basri">Basri</option>
                </select>
            </div>
                    <table id="transactionTable" class="table">
                        <thead class="d-none">
                            <tr>
                                <th>No</th>
                                <th>Nama Barang</th>
                                <th>Jumlah</th>
                                <th>Jenis</th>
                                <th class="d-none">Harga (Rp)</th>
                                <th>Total (Rp)</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                    <div class="total-section">
                        <!-- Total Keseluruhan -->
                        <div class="form-group">
                            <label for="updateGrandTotal" class="custom-label">Total:</label>
                            <input type="text" id="updateGrandTotal" class="form-control" readonly value="Rp 0">
                        </div>
                        <!-- Input field for Bayar -->
                        <div class="form-group">
                            <label for="paymentAmount" class="custom-label">Bayar:</label>
                            <input type="text" id="paymentAmount" class="form-control" oninput="calculateChange()" placeholder="Masukkan jumlah pembayaran">
                        </div>
                        <!-- Input field for Kembali -->
                        <div class="form-group">
                            <label for="changeAmount" class="custom-label">Kembali:</label>
                            <input type="text" id="changeAmount" class="form-control" readonly>
                        </div>

                        <!-- Print Button -->
                        <button class="btn btn-print" onclick="printReceipt()">
                            <i class="fas fa-print print-icon" style="color: blue;"></i> Cetak Nota
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <!-- Kotak di sebelah kanan -->
        <div class="col-md-6">
            <div id="barangSection">
                <label for="inputExcel" class="btn-import">
                    <i class="fas fa-file-excel" style="color: rgb(73, 249, 33);"></i> Import
                </label>
                <input type="file" id="inputExcel" accept=".xlsx, .xls" />
                <div id="searchContainer" class="mb-2">
                    <label for="searchInput">Cari:</label>
                    <input type="text" id="searchInput" class="form-control" placeholder="Cari berdasarkan abjad...">
                </div>
                <table id="barangTable" class="table table-bordered">
                    <thead>
                        <tr>
                            <th class="hidden">ID</th>
                            <th>Nama</th>
                            <th>Kategori</th>
                            <th>Pcs</th>
                            <th>Isi Pac</th>
                            <th>Isi Dos</th>
                            <th>Kulak</th>
                            <th>Hrg Pcs</th>
                            <th>Hrg Pac</th>
                            <th>Hrg Dos</th>
                            <th>Hrg Member</th>
                        </tr>
                    </thead>
                    <tbody id="bodyTable"></tbody>
                  </table>
            </div>
        </div>
    </div>
</div>

        <!-- Bootstrap JS, DataTables, and dependencies -->
        <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
        <script src="https://cdn.datatables.net/1.10.21/js/jquery.dataTables.min.js"></script>
        <script src="https://cdn.datatables.net/1.10.21/js/dataTables.bootstrap4.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/js/all.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
          <!-- Bootstrap JS and Popper.js -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
        <script>
    function toggleMenu() {
      var menu = document.getElementById("menuContent");
      if (menu.style.display === "block") {
        menu.style.display = "none";
      } else {
        menu.style.display = "block";
      }
    }
let selectedItem = null;
let transactions = [];
let importedData = []; // Menyimpan data Excel yang diimpor

// Event listener untuk perubahan file input
document.getElementById('inputExcel').addEventListener('change', handleFileSelect, false);

function handleFileSelect(event) {
    var file = event.target.files[0];
    var reader = new FileReader();

    reader.onload = function(e) {
        var data = new Uint8Array(e.target.result);
        var workbook = XLSX.read(data, { type: 'array' });
        
        // Ambil lembar pertama dari workbook
        var firstSheetName = workbook.SheetNames[0];
        var worksheet = workbook.Sheets[firstSheetName];
        
        // Konversi lembar menjadi format JSON
        importedData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
        // Simpan data ke localStorage
        localStorage.setItem('importedData', JSON.stringify(importedData));
                
        // Render tabel dengan data
        renderTable(importedData);
    };

    reader.readAsArrayBuffer(file);
}
document.addEventListener('DOMContentLoaded', () => {
    const savedData = localStorage.getItem('importedData');
    if (savedData) {
        importedData = JSON.parse(savedData);
        renderTable(importedData);
    } else {
        // Jika tidak ada data, panggil fungsi yang diperlukan (misalnya getAllBarang)
        getAllBarang();
    }
});
function handleFileSelect(event) {
    var file = event.target.files[0];
    var reader = new FileReader();

    reader.onload = function(e) {
        var data = new Uint8Array(e.target.result);
        var workbook = XLSX.read(data, { type: 'array' });
        
        var firstSheetName = workbook.SheetNames[0];
        var worksheet = workbook.Sheets[firstSheetName];
        
        // Konversi lembar menjadi format JSON
        importedData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
        
        // Hapus data lama dari localStorage
        localStorage.removeItem('importedData');
        
        // Simpan data yang baru ke localStorage
        localStorage.setItem('importedData', JSON.stringify(importedData));
        
        // Render tabel dengan data
        renderTable(importedData);
    };

    reader.readAsArrayBuffer(file);
}

function renderTable(data) {
    var tableBody = document.getElementById('bodyTable');

    // Hapus konten tabel sebelumnya
    tableBody.innerHTML = '';

    // Menentukan urutan header sesuai tabel HTML
    const headerOrder = ['ID', 'Nama', 'Kategori', 'Pcs', 'Isi Pac', 'Isi Dos', 'Kulak', 'Hrg Pcs', 'Hrg Pac', 'Hrg Dos', 'Hrg Member'];

    // Isi tabel body dengan data
    data.forEach(row => {
        var tr = document.createElement('tr');
        headerOrder.forEach(header => {
            var td = document.createElement('td');
            const index = headerOrder.indexOf(header);
            if (index < row.length) {
                td.textContent = row[index];
            } else {
                td.textContent = '';
            }
            tr.appendChild(td);
        });
        // Tambahkan event listener untuk memilih baris saat diklik
        tr.onclick = () => {
            selectedItem = row;
            document.getElementById('item').value = selectedItem[1]; // Asumsikan nama item ada di kolom 2
            document.getElementById('quantity').value = 1; // Kuantitas default
            updatePrice(); // Update harga berdasarkan jenis yang dipilih
            
            // Buka modal
            $('#itemModal').modal('show');
        };
        tableBody.appendChild(tr);
    });

    // Tampilkan tabel dan bagian pencarian
    document.getElementById('barangSection').style.display = 'block';

    var table = $('#barangTable').DataTable({
        destroy: true,
        paging: false,
        info: false,
        lengthChange: false,
        searching: false, // Nonaktifkan pencarian default DataTables
        columnDefs: [
            {
                targets: 0,
                visible: false
            }
        ]
    });

    $('#searchInput').on('keyup', function() {
        var searchTerm = this.value.toLowerCase(); // Ambil input pencarian
        table.rows().every(function() {
            var data = this.data(); // Ambil data dari baris
            var rowString = ''; // Gabungkan teks dari kolom untuk pencarian

            // Gabungkan kolom untuk pencarian
            for (var i = 1; i < data.length; i++) {
                rowString += data[i].toLowerCase() + ' ';
            }

            // Tampilkan atau sembunyikan baris berdasarkan istilah pencarian
            if (rowString.indexOf(searchTerm) !== -1) {
                $(this.node()).show(); // Tampilkan baris
            } else {
                $(this.node()).hide(); // Sembunyikan baris
            }
        });
    });
}
function getAllBarang() {
    // Logic to initialize or fetch data
    // Example: If you need to fetch data from a server or local source
    console.log('Fetching or initializing data...');
    
    // This is just an example; replace it with actual logic
    // e.g., fetching data from a server or setting default values
}
function getIsiIndex(priceType, dataRow) {
    switch (priceType) {
        case 'pcs': return dataRow[3];  // Ambil nilai dari kolom 'Isi Pcs'
        case 'pac': return dataRow[4];  // Ambil nilai dari kolom 'Isi Pac'
        case 'dos': return dataRow[5];  // Ambil nilai dari kolom 'Isi Dos'
        case 'mm': return dataRow[3];   // Ambil nilai dari kolom 'Isi MM'
        default: return 0;             // Nilai default jika jenis harga tidak cocok
    }
}
// Menetapkan event listeners ketika dokumen siap
document.addEventListener('DOMContentLoaded', () => {
    getAllBarang();
    // Ambil elemen input yang relevan
    const quantityInput = document.getElementById('quantity');
    const priceTypeSelect = document.getElementById('priceType');

    // Pasang event listener untuk mengupdate harga ketika quantity atau priceType berubah
    quantityInput.addEventListener('input', updatePrice);
    priceTypeSelect.addEventListener('change', updatePrice);

    // Jika ada elemen lainnya yang memerlukan pembaruan harga saat value-nya berubah
    const otherInputs = [/* Daftar elemen lainnya jika diperlukan */];
    otherInputs.forEach(input => {
        input.addEventListener('input', updatePrice);
    });
});

function updatePrice() {
    // Retrieve the selected price type, default to 'mm' if not set or invalid
    const priceType = document.getElementById('priceType').value || 'mm';
    const quantity = parseFloat(document.getElementById('quantity').value) || 1;
    const priceIndex = getPriceIndex(priceType);
    
    // Retrieve the data row, replace with the actual data source
    const dataRow = selectedItem || []; // Replace with the actual data row
    const price = parseFloat(dataRow[priceIndex]) || 0;
    const isi = getIsiIndex(priceType, dataRow) || 0;
    
    // Calculate jumlah (price x isi)
    const jumlah = price * isi;
    
    // Calculate total (jumlah x quantity)
    const total = jumlah * quantity;
    
    // Update price, isi, jumlah, and total fields in the form
    document.getElementById('price').value = Math.round(price); // Remove decimals
    document.getElementById('isi').value = Math.round(isi); // Remove decimals
    document.getElementById('jumlah').value = Math.round(jumlah); // Remove decimals
    document.getElementById('total').value = Math.round(total); // Remove decimals
}

// Fungsi untuk mendapatkan indeks kolom harga berdasarkan jenis harga
function getPriceIndex(priceType) {
    switch (priceType) {
        case 'pcs': return 7; // Misalkan harga per pcs ada di kolom ke-8
        case 'pac': return 8; // Misalkan harga per pac ada di kolom ke-9
        case 'dos': return 9; // Misalkan harga per dos ada di kolom ke-10
        case 'mm': return 10; // Misalkan harga per mm ada di kolom ke-11
        default: return 7;
    }
}

function addTransaction() {
    // Ambil nilai dari form
    const itemName = document.getElementById('item').value;
    const quantity = parseInt(document.getElementById('quantity').value) || 1; // Default to 1 if quantity is not set
    const priceType = document.getElementById('priceType').value || 'mm'; // Default to 'mm' if not set
    const pricePerUnit = parseFloat(document.getElementById('jumlah').value) || 0; // Update this to use 'price' field
    const total = parseFloat(document.getElementById('total').value) || 0; // Use 'total' field directly

    // Validasi input
    if (itemName && quantity > 0 && pricePerUnit > 0) {
        // Tambahkan data transaksi ke array global
        transactions.push({
            itemName: itemName,
            quantity: quantity,
            priceType: priceType,
            pricePerUnit: pricePerUnit,
            total: total
        });

        // Tambahkan baris ke tabel
        const tbody = document.querySelector('#transactionTable tbody');

        // Baris untuk Nomor Urut dan Nama Barang
        let tr = document.createElement('tr');
        tr.classList.add('service');
        tr.innerHTML = `
            <td class="tableitem">
                <div class="combined-content" colspan="4">
                    <p class="itemtext">${itemName}</p>
                </div>
            </td>
        `;
        tbody.appendChild(tr);

        // Baris untuk Jumlah, Jenis, Harga, dan Total
        tr = document.createElement('tr');
        tr.classList.add('service');
        tr.innerHTML = `
            <td class="tableitem">
                <div class="combined-content">
                    <p class="itemtext">${priceType} ${quantity} x ${pricePerUnit.toFixed(0)} =</p>
                </div>
            </td>                             
            <td class="tableitem"><p class="itemtext">${total.toFixed(0)}</p></td>
            <td><button class="btn-no-bg" onclick="removeRow(this)">
                <i class="fas fa-trash"></i> <!-- Ikon hapus -->
            </button></td>
        `;
        tbody.appendChild(tr);

        // Update grand total dan reset form
        updateGrandTotal();
        resetForm();
        // Tutup modal setelah transaksi ditambahkan
        const myModalEl = document.getElementById('itemModal');
        // Jika Bootstrap 4 atau lebih lama
        $(myModalEl).modal('hide');
    } else {
        alert('Silakan lengkapi informasi transaksi.');
    }
}
// Event listener untuk tombol close, tidak terganggu oleh addTransaction()
$(document).ready(function() {
    // Membuat tombol close bekerja dengan baik
    $('.close').on('click', function(e) {
        e.stopPropagation(); // Pastikan event tidak terganggu
        $('#itemModal').modal('hide'); // Tutup modal
    });
});
function searchTransaction() {
    const code = document.getElementById('searchCode').value.trim();
    const history = JSON.parse(localStorage.getItem('transactionHistory')) || [];
    const filteredHistory = history.filter(transaction => transaction.code.toLowerCase() === code.toLowerCase());

    // Clear the table body before displaying the search results
    const tableBody = document.getElementById('transactionTable').querySelector('tbody');
    tableBody.innerHTML = '';

    if (filteredHistory.length > 0) {
        filteredHistory.forEach(transaction => {
            // Generate item details rows similar to addTransaction
            transaction.items.forEach((item, itemIndex) => {
                const itemName = item.itemName;
                const quantity = item.quantity;
                const priceType = item.priceType;
                const pricePerUnit = item.pricePerUnit;
                const total = item.total;

                // Baris untuk Nomor Urut dan Nama Barang
                let tr = document.createElement('tr');
                tr.classList.add('service');
                tr.innerHTML = `
                    <td class="tableitem">
                        <div class="combined-content" colspan="4">
                            <p class="itemtext">${itemName}</p>
                        </div>
                    </td>
                `;
                tableBody.appendChild(tr);

                // Baris untuk Jumlah, Jenis, Harga, dan Total
                tr = document.createElement('tr');
                tr.classList.add('service');
                tr.innerHTML = `
                    <td class="tableitem">
                        <div class="combined-content">
                            <p class="itemtext">${priceType} ${quantity} x ${pricePerUnit.toFixed(0)} =</p>
                        </div>
                    </td>
                    <td class="tableitem"><p class="itemtext">${total.toFixed(0)}</p></td>
                    <td><button class="btn-no-bg" onclick="removeRow(this)">
                        <i class="fas fa-trash"></i> <!-- Ikon hapus -->
                    </button></td>
                `;
                tableBody.appendChild(tr);
            });

            const summaryAndCount = `
                ${transaction.summary && transaction.summary.grandTotal !== undefined ? 
                    `<tr class="service">
                        <td class="tableitem" colspan="2" style="text-align: left; white-space: nowrap;"><h2>Total: ${transaction.summary.grandTotal}</h2></td>
                    </tr>` : ''
                }
                ${transaction.summary && transaction.summary.paymentAmount !== undefined ? 
                    `<tr class="service">
                        <td class="tableitem" colspan="2" style="text-align: left; white-space: nowrap;"><h2>Bayar: ${transaction.summary.paymentAmount}</h2></td>
                    </tr>` : ''
                }
                ${transaction.summary && transaction.summary.changeAmount !== undefined ? 
                    `<tr class="service">
                        <td class="tableitem" colspan="2" style="text-align: left; white-space: nowrap;"><h2>Kembali: ${transaction.summary.changeAmount}</h2></td>
                    </tr>` : ''
                }
                ${transaction.itemCount !== undefined ? 
                    `<tr class="service">
                        <td class="tableitem" colspan="2" style="text-align: left; white-space: nowrap;"><h2>Jumlah Item: ${transaction.itemCount}</h2></td>
                    </tr>` : ''
                }
            `;

            // Create a summary row for the transaction
            const summaryRow = `
                <tr>
                    <td colspan="2">
                        <table style="font-size: 10px;">${summaryAndCount}</table>
                    </td>
                    <td>
                        <button class="btn-no-bg" onclick="removeRow(this)">
                            <i class="fas fa-trash"></i> <!-- Ikon hapus -->
                        </button>
                    </td>
                </tr>
            `;

            // Append summary row to table body
            tableBody.innerHTML += summaryRow;
        });
    } else {
        // If no transaction found, show a message
        tableBody.innerHTML = `<tr><td colspan="5" style="text-align: center;">Transaksi tidak ditemukan</td></tr>`;
    }
}


    // Function to populate the dropdown with transaction codes from localStorage
    function populateTransactionCodes() {
        const history = JSON.parse(localStorage.getItem('transactionHistory')) || [];
        const select = document.getElementById('transactionSelect');
        
        history.forEach(transaction => {
            const option = document.createElement('option');
            option.value = transaction.code;
            option.textContent = transaction.code; // Display code in dropdown
            select.appendChild(option);
        });
    }

    function selectTransactionCode() {
        const select = document.getElementById('transactionSelect');
        const searchCodeInput = document.getElementById('searchCode');
        searchCodeInput.value = select.value; // Set input to selected code
    }
    // Populate the transaction codes when the page loads
    window.onload = populateTransactionCodes;
// Fungsi untuk mendapatkan tanggal saat ini dalam format "dddd, mmmm dd, yyyy"
function getCurrentDate() {
    const days = ['Minggu', 'Senin', 'Selasa', 'Rabu', 'Kamis', 'Jumat', 'Sabtu'];
    const months = ['Januari', 'Februari', 'Maret', 'April', 'Mei', 'Juni', 'Juli', 'Agustus', 'September', 'Oktober', 'November', 'Desember'];

    const now = new Date();
    const dayName = days[now.getDay()]; // Nama hari
    const day = now.getDate(); // Tanggal
    const monthName = months[now.getMonth()]; // Nama bulan
    const year = now.getFullYear(); // Tahun

    return `${dayName}, ${day} ${monthName}, ${year}`;
}

// Mendapatkan tanggal saat ini
const currentDate = getCurrentDate(); 

// Menampilkan tanggal ke konsol
console.log(currentDate);
function updateGrandTotal() {
    let total = 0;
    
    // Loop through each row in the table and calculate the total
    document.querySelectorAll('#transactionTable tbody tr').forEach(row => {
        const totalCell = row.querySelector('td:nth-child(2)'); // Adjusted to get the correct 'Total' column
        if (totalCell) {
            const value = parseFloat(totalCell.textContent.replace(/[^\d.-]/g, '')); // Remove non-numeric characters
            total += !isNaN(value) ? value : 0;
        }
    });

    // Update the input field with the calculated total, formatted in Indonesian Rupiah format
    document.getElementById('updateGrandTotal').value = `Rp ${total.toLocaleString('id-ID', {maximumFractionDigits: 0})}`;
}
function removeRow(button) {
            // Get the row that contains the delete button
            const rowToRemove = button.closest('tr');
            const previousRow = rowToRemove.previousElementSibling;

            // Remove both rows
            if (previousRow && rowToRemove) {
                previousRow.remove();
                rowToRemove.remove();
                updateGrandTotal();
            }
        }
        // Fungsi untuk menghitung kembali otomatis
document.getElementById('paymentAmount').addEventListener('input', function(e) {
    // Ambil nilai yang diinput, hapus simbol non-angka
    let input = e.target.value.replace(/\D/g, '');

    // Jika input ada isinya, format menjadi mata uang, jika kosong biarkan kosong
    if (input) {
        input = parseInt(input, 10).toLocaleString('id-ID').replace(/,/g, '.'); // Format angka dengan titik
        e.target.value = `Rp ${input}`; // Tambahkan "Rp" di depan
    } else {
        e.target.value = ''; // Kosongkan kolom bayar jika input dihapus
    }

    // Panggil fungsi hitung kembalian
    calculateChange();
});
function calculateChange() {
    // Ambil nilai grand total dan hapus simbol Rp dan tanda ribuan
    const grandTotal = parseFloat(document.getElementById('updateGrandTotal').value.replace('Rp ', '').replace(/\./g, '').replace(/,/g, '.'));

    // Ambil nilai pembayaran (bayar) dan hapus simbol Rp dan tanda ribuan
    const payment = parseFloat(document.getElementById('paymentAmount').value.replace('Rp ', '').replace(/\./g, '').replace(/,/g, '.'));

    // Hitung kembalian
    let change = payment - grandTotal;

    // Tetap tampilkan nilai negatif jika bayar kurang dari total
    if (isNaN(change)) {
        change = 0;  // Jika hasil perhitungan invalid, set ke 0
    }

    // Format hasil kembalian ke format Rupiah
    const formattedChange = `Rp ${Math.floor(change).toLocaleString('id-ID').replace(/,/g, '.')}`;

    // Set nilai kembalian ke input changeAmount
    document.getElementById('changeAmount').value = formattedChange;

    return {
        grandTotal: `Rp ${grandTotal.toLocaleString('id-ID').replace(/,/g, '.')}`,
        paymentAmount: `Rp ${payment.toLocaleString('id-ID').replace(/,/g, '.')}`,
        changeAmount: formattedChange
    };
}
function refreshPage() {
            // Refresh halaman
            location.reload();
        }
function resetForm() {
                document.getElementById('item').value = '';
                document.getElementById('quantity').value = '';
                document.getElementById('price').value = '';
                document.getElementById('priceType').value = 'mm';
            }
            
        // Call getAllBarang when the document loads
        document.addEventListener('DOMContentLoaded', getAllBarang);
// Function to clear the transaction list
function clearTransactionList() {
    // Clear the transactions array
    transactions = [];

    // Clear the table body
    const tbody = document.querySelector('#transactionTable tbody');
    tbody.innerHTML = '';
}        
function loadTransactionCode() {
    // Check if a transaction code exists in local storage and increment it
    const lastTransactionCode = localStorage.getItem('lastTransactionCode');
    if (lastTransactionCode) {
        const num = parseInt(lastTransactionCode.replace('MR', '')) + 1;
        transactionCode = `MR${String(num).padStart(5, '0')}`;
    }
}

function saveTransactionToHistory(transactions, transactionSummary, itemCount) {
    loadTransactionCode();

    // Get current transaction history from local storage
    const history = JSON.parse(localStorage.getItem('transactionHistory')) || [];

    // Add the new transaction to the history
    const newTransaction = {
        code: transactionCode,
        date: getCurrentDate(),
        cashier: document.getElementById('nameDropdown').value,
        items: transactions,
        summary: {
            grandTotal: transactionSummary.grandTotal,
            paymentAmount: transactionSummary.paymentAmount,
            changeAmount: transactionSummary.changeAmount,
        },
        itemCount: itemCount
    };
    
    history.push(newTransaction);

    // Save updated history and transaction code to local storage
    localStorage.setItem('transactionHistory', JSON.stringify(history));
    localStorage.setItem('lastTransactionCode', transactionCode);
}

        function printReceipt() {
    // Pastikan data transaksi ada
    if (!transactions || transactions.length === 0) {
        alert('Tidak ada transaksi untuk dicetak.');
        return;
    }

    // Fetch the selected cashier's name
    const cashierDropdown = document.getElementById('nameDropdown');
    const selectedCashier = cashierDropdown ? cashierDropdown.value : 'Unknown';
// Generate the table rows based on the stored transaction data
let rows = '';
transactions.forEach((data, index) => {
    rows += `
        <tr class="service">
            <td class="tableitem" colspan="2">
                <p class="itemtext">${index + 1}. ${data.itemName}</p> <!-- Nomor urut otomatis -->
            </td>
        </tr>
            <tr class="service">
                <td class="tableitem">
                    <div class="combined-content">
                        <p class="itemtext">${data.priceType} ${data.quantity}        x ${data.pricePerUnit.toFixed(0)}</p>
                    </div>
                </td>
                <td class="tableitem"><p class="itemtext">=${data.total.toFixed(0)}</p></td>
            </tr>
        `;
    });
    // Insert the generated rows into the table inside the <div>
    const tableHTML = `
        <table>
            ${rows}
        </table>
    `;
    // Hitung nilai total, bayar, dan kembalian
    const transactionSummary = calculateChange();
        // Calculate the total number of items
        const itemCount = transactions.length;
    // Ambil tanggal saat ini menggunakan fungsi getCurrentDate()
    const currentDate = getCurrentDate();

    // Open a new window for printing
    const printWindow = window.open('', '_blank');
    printWindow.document.open();

    // Write the HTML for the print page
    printWindow.document.write(`
            <!DOCTYPE html>
            <html lang="en">
            <head>
                <meta charset="UTF-8">
                <title>Nota</title>
                <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
                <style>
                            /* Add styles for printing */
                    body { font-family: 'Poppins', sans-serif; }
                    .tableitem { /* Your styles here */ }
                    .hide-column { display: none; }
                    .combined-content { /* Your styles here */ }
                    .itemtext { /* Your styles here */ }
                    /* Add more styles as needed */
                    @media print {
                .page-break { display: block; page-break-before: always; }
            }
                #invoice-POS {
            box-shadow: 0 0 1in -0.25in rgba(0, 0, 0, 0.5);
            padding: 2mm;
            margin: 0 auto;
            width: 44mm;
            background: #FFF;
            }
            #invoice-POS ::selection {
            background: #f31544;
            color: #FFF;
            }
            #invoice-POS ::moz-selection {
            background: #f31544;
            color: #FFF;
            }
            #invoice-POS h1 {
            font-size: 1.5em;
            color: #222;
            }
            #invoice-POS h2 {
            font-size: .9em;
            }
            #invoice-POS h3 {
            font-size: 1.2em;
            font-weight: 300;
            line-height: 2em;
            }
            #invoice-POS p {
            font-size: .5em;
            color: #000000;
            line-height: 1.2em;
            text-align: left;
            margin-top: 0;
            margin-bottom: 0;
            }
            #invoice-POS #top, #invoice-POS #mid, #invoice-POS #bot {
            /* Targets all id with 'col-' */
            position: relative;
            border-bottom: 1px dotted hsl(0, 47%, 46%);
            }
            #invoice-POS #top::after,
            #invoice-POS #mid::after,
            #invoice-POS #bot::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: -5px; /* adjust distance between lines */
            width: 100%;
            border-bottom: 1px dotted hsl(0, 47%, 46%);
            }
            #invoice-POS #top {
            min-height: 90px;
            }
            #invoice-POS #mid {
            min-height: 0px;
            }
            #invoice-POS #bot {
            min-height: 50px;
            margin: 0;
            }
            #invoice-POS #top .logo-img {
            height: 38px; /* Adjust height to fit within POS format */
            width: auto; /* Keep aspect ratio */
            display: block; /* Remove extra space below the image */
            margin: 0 auto; /* Center align the image */
            }
            #invoice-POS .info {
            display: block;
            margin-left: 0;
            }
            #invoice-POS .title {
            float: right;
            }
            #invoice-POS .title p {

            text-align: right;
            }
            #invoice-POS table {
            width: 100%;
            margin-top: 5px;
            font-size: 25px
            font-weight: bold;
            }
            #invoice-POS .tabletitle {
                font-size: .5em;
                margin: 0;
                white-space: nowrap; /* Prevents wrapping */
            }
            #invoice-POS .tabletitle td h2 {
                white-space: nowrap; /* Prevents wrapping for H2 */
            }
            #invoice-POS .service {
            border-bottom: 0px solid #EEE;
            }
                .tableitem p.itemtext {
                margin: 0;
                padding: 0px 0; /* Atur padding sesuai kebutuhan */
                line-height: 1.2;
            }
            
            table td {
                padding: 0; /* Menghapus padding pada td jika diperlukan */
            }
            
            table {
                width: 100%; /* Atur lebar tabel sesuai kebutuhan */
            }
            
            /* Untuk visualisasi */
            table, td {
                border: 0px solid #ddd; /* Contoh border */
            }
            #invoice-POS .item {
            width: 24mm;
            }
#invoice-POS .itemtext {
    font-size: .7em;
    text-align: left;
    overflow: hidden;    /* Sembunyikan teks yang melampaui lebar elemen */
    text-overflow: ellipsis; /* Gantikan teks yang terpotong dengan "..." */
}

            #invoice-POS #legalcopy {
            margin-top: 5mm;
            }
            h2 {margin: 0.2rem;}
            h6 {margin: 0;}
            h5 {margin: 0;
            font-size: xx-small;
            font-family: 'Poppins', sans-serif;}
            .hide-column {
                display: none !important;
            }
                    /* Style for centering the buttons */
        .modal-buttons {
            display: flex;
            justify-content: center;  /* Center the buttons horizontally */
            margin-top: 20px;
        }

        /* Style for individual buttons */
        .modal-buttons .print-btn, 
        .modal-buttons button {
            background-color: #4CAF50; /* Green background */
            color: white;  /* White text */
            padding: 10px 20px;  /* Button padding */
            border: none;  /* Remove default border */
            border-radius: 5px;  /* Rounded corners */
            font-size: 16px;  /* Font size */
            margin: 0 10px;  /* Space between buttons */
            cursor: pointer;  /* Pointer cursor */
            transition: background-color 0.3s ease;  /* Transition effect */
        }

        /* Hover effect for buttons */
        .modal-buttons .print-btn:hover {
            background-color: #45a049;  /* Darker green when hovering */
        }

        .modal-buttons button:hover {
            background-color: #f44336;  /* Red when hovering for the close button */
        }

        /* Hide the buttons when printing */
        @media print {
            .modal-buttons {
                display: none;
            }
        /* Control page margins and content alignment */
            body {
                margin: 0;
                padding: 0;
                background-color: white; /* Ensure the background is white */
            }

            .printable-area {
                max-width: 100%;
                page-break-inside: avoid; /* Avoid breaking inside the content */
            }

            /* Optional: Limit paper size if required */
            @page {
                size: auto; /* Automatically adjust to content */
                margin: 0; /* Set page margins */
            }

            /* Optional: Prevent empty pages if content is smaller */
            html, body {
                height: auto; /* Adjust the height to the content */
            }
            .itemtext {
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 100%;
            font-size: .7em;
            }
        }

    </style>
</head>
<body translate="no">
    <div class="printable-area">
  <div id="invoice-POS">

    <center id="top">
      <div class="logo"></div>
      <h2>Toko</h2>
      <img src="https://github.com/MerpatiQuu/M/blob/main/Preview%202.png?raw=true" alt="Logo" class="logo-img">
      <div class="info">
        <h5>Beddian-Jambesari Ds-Bondowoso</h5>
        <h6>No.HP 082257730020</h6>
      </div><!--End Info-->
    </center><!--End InvoiceTop-->

    <div id="mid">
      <div class="info">
    <table>
                <tr>
            <td>
                <p>Kode Trx: ${transactionCode}</p> 
            </td>
        </tr>
        <tr>
            <td>
                <p>Tgl: ${currentDate}</p> <!-- Tanggal saat ini -->
            </td>
        </tr>
        <tr>
            <td>
                <p>Kasir: ${selectedCashier}</p>
            </td>
        </tr>
    </table>
    </div>
</div><!--End Invoice Mid-->

        <div id="bot">
            <div id="table">
                <table>
                    ${rows}
                    <tr>
                        <td colspan="2" style="border-top: 2px solid #000; padding: 0;"></td>
                    </tr>
                    <tr class="tabletitle">
                        <td class="Rate" style="text-align: left; white-space: nowrap;"><h2>Total: ${transactionSummary.grandTotal}</h2></td>
                    </tr>
                    <tr class="tabletitle">
                        <td class="Rate" style="text-align: left; white-space: nowrap;"><h2>Bayar: ${transactionSummary.paymentAmount}</h2></td>
                    </tr>
                    <tr class="tabletitle">
                        <td class="Rate" style="text-align: left; white-space: nowrap;"><h2>Kembali: ${transactionSummary.changeAmount}</h2></td>
                    </tr>
                    <tr class="tabletitle">
                            <td class="Rate" style="text-align: left; white-space: nowrap;"><h2>Jumlah Item: ${itemCount}</h2></td>
                        </tr>
            </table>                    
            </div><!--End Table-->
            </div>
            <div id="legalcopy">
                <h6 class="legal" style="text-align: center;"><strong>Harga Selaras Belanja Puas</strong></h6>
                <h6 class="legal" style="text-align: center;"><strong>Mator Sekalangkong</strong></h6>
                <h6 class="legal" style="text-align: center;"><strong>-</strong></h6>
            </div>
        </div>
    </div>
</div>
    <div class="modal-buttons">
        <button class="print-btn" onclick="window.print()">Print</button>
        <button onclick="window.close()">Close</button>
    </div>
</body>
</html>
`);
            printWindow.document.close();
            printWindow.print();
             // Save transaction to history
             saveTransactionToHistory(transactions, transactionSummary, itemCount);
            // Clear the transaction list after printing
            clearTransactionList();
            transactions = [];
            }
    </script>
        </body>
        </html>
